#!/usr/bin/env python
import argparse
from subprocess import Popen, PIPE, STDOUT

def branch():
    process = Popen(['git branch'], shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE, )
    output, _ = process.communicate()
    return output

def create_branch(name):
    process = Popen(['git checkout -b {}'.format(name)], shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE, )
    output, _ = process.communicate()

def say(phrase):
    process = Popen(['say {}'.format(phrase)], shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE, )
    output, _ = process.communicate()

def new(branch_name):
    create_branch(branch_name)

def add_all():
    process = Popen(['git add .'], shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE, )
    output, _ = process.communicate()

def commit_all(message="wip"):
    process = Popen(['git commit -m {}'.format(message)], shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE, )
    output, _ = process.communicate()

def push_all():
    process = Popen(['git push origin'], shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE, )
    output, _ = process.communicate()

def next():
    add_all()
    commit_all()
    push_all()
    print("pushed to branch!")


parser = argparse.ArgumentParser(description='mobn git handoff tool')
parser.add_argument('command', help='the command (eg say, new)')
parser.add_argument('arguments', nargs='*',
                    help='arguments to the command (eg huhuhu)')
args = parser.parse_args()

if args.command == "say":
    say(' '.join(args.arguments))
elif args.command == "new":
    new(args.arguments[0])
elif args.command == "next":
    next()

if __name__ == '__main__':
    pass
    # say("huhuhuhuhuhuhuhuh")
